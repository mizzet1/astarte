{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",

  "description": "Renovate configuration for Astarte",

  "extends": [
    "config:recommended",
    ":maintainLockFilesWeekly",
    ":rebaseStalePrs",
    ":semanticCommits",
    ":semanticCommitScope(deps)",
    "helpers:pinGitHubActionDigests"
  ],

  "dependencyDashboard": true,
  "dependencyDashboardApproval": false,

  "prCreation": "immediate",
  "rebaseWhen": "behind-base-branch",

  "platformAutomerge": true,
  "automergeType": "branch",

  "packageRules": [
    {
      "description": "Elixir patch and minor updates - automerge",
      "matchManagers": ["mix"],
      "matchUpdateTypes": ["patch", "minor"],
      "automerge": true,
      "labels": ["dependencies", "elixir", "automerge"]
    },
    {
      "description": "Elixir major updates - manual, monthly",
      "matchManagers": ["mix"],
      "matchUpdateTypes": ["major"],
      "schedule": ["before 10am on the first day of the month"],
      "automerge": false,
      "labels": ["dependencies", "elixir", "major"]
    },
    {
      "description": "GitHub Actions updates",
      "matchManagers": ["github-actions"],
      "automerge": true,
      "labels": ["dependencies", "ci", "automerge"]
    }
  ],

  "mix": {
    "enabled": true
  },

  "github-actions": {
    "enabled": true
  },

  "separateMajorMinor": true,
  "separateMinorPatch": false,

  "labels": ["renovate"],
  "timezone": "UTC"
}
